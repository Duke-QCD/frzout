/*
 * Tables of Gauss quadrature abscissas and weights, pre-calculated to high
 * precision in Mathematica.
 */

typedef struct QuadPoint {
  double x;  // abscissa
  double w;  // weight
} QuadPoint;

/*
 * Gauss-Legendre abscissas and weights for integrating the Breit-Wigner
 * distribution over [m_min, m_max].  Only the first half of the table is
 * listed; the second half follows by symmetry.
 *
 * The abscissas must be translated from [0, 1] to [m_min, m_max] and the final
 * result multiplied by (m_max - m_min).
 *
 * Typical relative error ~ 10^-7.
 *
 * Mathematica code:
 *
 *   n = 64;
 *   P = LegendreP[n, x];
 *   xi = Root[P, #] & /@ Range[n/2];
 *   wi = 2/((1 - x^2) D[P, x]^2) /. x -> xi;
 *   Transpose@N[{(xi + 1), wi}/2, 18]
 */

#define NQUADPTS_M 32

static const QuadPoint quadpts_m[NQUADPTS_M] = {
  {0.000347479132113930272, 0.000891640360848216474},
  {0.00182994161402236033,  0.00207351663028123382},
  {0.00449331426162783963,  0.00325222898448918143},
  {0.00833187305768702153,  0.00442337991318197386},
  {0.0133365861050445181,   0.00558406973006556441},
  {0.0194956001739731405,   0.00673152394835932130},
  {0.0267943125707985920,   0.00786301523801235966},
  {0.0352154139340302121,   0.00897585788784867154},
  {0.0447389314607485971,   0.0100674115767651047},
  {0.0553422770024429471,   0.0111350869041916271},
  {0.0670003009229535901,   0.0121763512843554367},
  {0.0796853518737098186,   0.0131887348575273293},
  {0.0933673424386012201,   0.0141698363071297416},
  {0.108013820528329296,    0.0151173285362012394},
  {0.123590046369734052,    0.0160289641774257768},
  {0.140059074914194587,    0.0169025809185708047},
  {0.157381843472883379,    0.0177361066284411919},
  {0.175517264372671330,    0.0185275642701200230},
  {0.194422322413803375,    0.0192750765893078146},
  {0.214052176898682983,    0.0199768705663601707},
  {0.234360267990052727,    0.0206312816213117643},
  {0.255298427146473521,    0.0212367575618267945},
  {0.276816991373267956,    0.0217918622646617267},
  {0.298864921018004198,    0.0222952790818782815},
  {0.321389920831165942,    0.0227458139637090722},
  {0.344338564004894522,    0.0231423982906572086},
  {0.367656418895616292,    0.0234840914081050087},
  {0.391288178129996458,    0.0237700828574151543},
  {0.415177789788003591,    0.0239996942982291539},
  {0.439268590351939723,    0.0241723811174014786},
  {0.463503439106100480,    0.0242877337207517135},
  {0.487824853668287784,    0.0243454785045698602}
};

/*
 * Gauss-Laguerre abscissas and weights for integrating momentum (d^3p ~ p^2 dp)
 * over [0, infinity).
 *
 * These are calculated from the generalized Laguerre polynomial L_64^2 and
 * therefore include the p^2 Jacobian.
 *
 * The integration variable x = p/T.  The final sum must therefore be multiplied
 * by T^3 to account for the change of variables.
 *
 * The weights are pre-multiplied by the usual prefactor (4*pi)/(2*pi*hbarc)^3.
 *
 * The weights are pre-multiplied by exp(x) because the momentum-space
 * integrands don't have an exact exp(-x) weight.  This causes the weights to
 * increase with x, but the overall sum will still converge since the integrands
 * always divide by (exp(sqrt((m/T)^2 + x^2)) +/- 1).
 *
 * The abscissas are scaled by 1/4 to move more of them back where the integrand
 * is non-negligible.  This improves accuracy, especially for small masses.  The
 * weights are scaled by (1/4)^3 to account for the change of variables.
 *
 * Typical relative error ~ 10^-14.
 *
 * Mathematica code:
 *
 *   n = 64;
 *   \[Alpha] = 2;
 *   \[HBar]c = 0.1973269788`50;
 *   L = LaguerreL[n, \[Alpha], x];
 *   xi = Root[L, #] & /@ Range@n;
 *   wi = (Gamma[n + \[Alpha] + 1] x)/(
 *      n! (n + 1)^2 LaguerreL[n + 1, \[Alpha], x]^2) /. x -> xi;
 *   a = 1/4;
 *   Transpose@
 *     N[{a xi, (4 \[Pi])/(2 \[Pi] \[HBar]c)^3 a^(\[Alpha] + 1)
 *         wi Exp[xi]}, 18]
 */

#define NQUADPTS_P 64

static const QuadPoint quadpts_p[NQUADPTS_P] = {
  { 0.0251705763534742851,   0.000138232020486169274},
  { 0.0676302091208335242,   0.00156400739555644405},
  { 0.128924908982230010,    0.00775234059452739843},
  { 0.209122002228865398,    0.0258544830354259966},
  { 0.308274355325163925,    0.0680787725733124285},
  { 0.426441673389768351,    0.153112797270017791},
  { 0.563693879506642505,    0.307598979143212243},
  { 0.720112117419670958,    0.567676402480166901},
  { 0.895789264282390506,    0.980602669916928005},
  { 1.09083033277024230,     1.60647074583156600},
  { 1.30535286524612051,     2.52003716858366690},
  { 1.53948735509226571,     3.81267971493480706},
  { 1.79337771049573215,     5.59450462349720908},
  { 2.06718176950964738,     7.99662588042857962},
  { 2.36107187311454421,    11.1736419021553956},
  { 2.67523550254297209,    15.3063382926098564},
  { 3.00987598738090499,    20.6046492989147307},
  { 3.36521329158389982,    27.3109152527685903},
  { 3.74148488542026712,    35.7034788034919733},
  { 4.13894671243889279,    46.1006692929177006},
  { 4.55787426185579468,    58.8652324017007270},
  { 4.99856375828204030,    74.4092714705365896},
  { 5.46133348251182540,    93.1997779903691681},
  { 5.94652523920166479,   115.764842064885590},
  { 6.45450598976167446,   142.700649680314041},
  { 6.98566967172555106,   174.679393006580295},
  { 7.54043922936421016,   212.458243504281518},
  { 8.11926888448063223,   256.889566347769300},
  { 8.72264668132283686,   308.932589907901986},
  { 9.35109734557053298,   369.666787460084835},
  {10.0051855046330866,    440.307282088761420},
  {10.6855193253537793,    522.222652816092734},
  {11.3927546360485545,    616.955604064223087},
  {12.1275996131350521,    726.247066672851487},
  {12.8908201291057038,    852.064433530088787},
  {13.6832458791552913,    996.634805462560388},
  {14.5057774295657326,   1162.48434565925669},
  {15.3593943635526583,   1352.48513046492419},
  {16.2451647418135297,   1569.91126433596259},
  {17.1642561483815113,   1818.50653005985342},
  {18.1179486615742883,   2102.56651884002804},
  {19.1076501803978793,   2427.03909598017894},
  {20.1349146565801554,   2797.64830510346038},
  {21.2014639427128743,   3221.04854295370091},
  {22.3092141841052370,   3705.01826742662906},
  {23.4603079799905137,   4258.70597000626882},
  {24.6571539548488006,   4892.94617565710267},
  {25.9024759681446364,   5620.67066634885542},
  {27.1993750371539077,   6457.45132608593318},
  {28.5514082909042985,   7422.22826430123195},
  {29.9626911400680904,   8538.30413172075227},
  {31.4380317200456439,   9834.72980256249834},
  {32.9831112082148034,  11348.2807601139635},
  {34.6047310344220127,  13126.3523349309478},
  {36.3111605629827899,  15231.3351336609523},
  {38.1126410077192325,  17747.4750421238227},
  {40.0221425339898085,  20792.1135253591818},
  {42.0565527307492352,  24535.1251963911372},
  {44.2386470720471409,  29234.8778648838289},
  {46.6005937007024952,  35310.8210221616478},
  {49.1908016928274278,  43508.2851016486729},
  {52.0892099305897499,  55341.2995682983520},
  {55.4492772322593997,  74647.1178058862433},
  {59.6676359899433879, 116784.318943680047}
};
